<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</title>
  <style>
    :root{--bg:#f5f5f7;--card:#fff;--text:#222;--muted:#666;--accent:#0a84ff;}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font:16px/1.45 system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:var(--bg);color:var(--text);}
    header{position:fixed;top:0;left:0;right:0;height:56px;background:var(--card);display:flex;align-items:center;justify-content:center;border-bottom:1px solid #e0e0e0;z-index:10}
    header h1{font-size:18px;font-weight:600}
    main{padding:72px 16px 80px;max-width:960px;margin:0 auto}
    .level-select{display:flex;flex-direction:column;gap:14px;align-items:center;margin-top:40px}
    .level-select button{width:180px;padding:12px;border-radius:12px;border:1px solid #d0d0d0;background:var(--card);font-size:16px;cursor:pointer}
    .topics{display:flex;flex-direction:column;gap:12px;margin-top:20px}
    .topics li{list-style:none;background:var(--card);padding:12px;border:1px solid #e0e0e0;border-radius:12px}
    .brand-list,.article-list{display:flex;flex-direction:column;gap:12px;margin-top:20px}
    .brand-list div,.article-list div{background:var(--card);padding:14px;border:1px solid #e0e0e0;border-radius:12px}
    .article{background:var(--card);padding:16px;border:1px solid #e0e0e0;border-radius:12px;margin-top:20px}
    footer.tabs{position:fixed;bottom:0;left:0;right:0;height:64px;background:var(--card);border-top:1px solid #e0e0e0;display:flex;z-index:10}
    footer.tabs button{flex:1;border:none;background:none;font-size:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;color:var(--muted);cursor:pointer}
    footer.tabs button span{font-size:20px;margin-bottom:4px}
    footer.tabs button.active{color:var(--accent)}
    .back{margin-top:8px;margin-bottom:8px;background:none;border:none;color:var(--accent);cursor:pointer;font-size:14px}
  </style>
</head>
<body>
  <header><h1>–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</h1></header>
  <main id="view"></main>
  <footer class="tabs">
    <button class="active" data-tab="info"><span>‚åö</span>–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
    <button data-tab="brands"><span>üè∑Ô∏è</span>–ë—Ä–µ–Ω–¥—ã</button>
    <button data-tab="articles"><span>üì∞</span>–°—Ç–∞—Ç—å–∏</button>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.1/dist/umd/supabase.min.js"></script>
  <script>
    const view = document.getElementById('view');
    const tabs = document.querySelectorAll('footer.tabs button');
    tabs.forEach(b=>b.addEventListener('click',()=>{showTab(b.dataset.tab);}));

    // Supabase initialization
    const SUPABASE_URL = 'https://YOUR_PROJECT.supabase.co';
    const SUPABASE_KEY = 'YOUR_SUPABASE_ANON_KEY';
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const levelNames = {base:'–ë–∞–∑–æ–≤—ã–π',advanced:'–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π',pro:'–ü—Ä–æ—Ñ–∏'};
    let categories = [];
    let articles = [];
    let currentCategory = null;

    async function loadData(){
      const { data:cats } = await sb.from('categories').select('*');
      categories = cats || [];
      const { data:arts } = await sb.from('articles').select('*');
      articles = arts || [];
      renderInfoHome();
    }

    function showTab(tab){
      tabs.forEach(b=>b.classList.toggle('active', b.dataset.tab===tab));
      if(tab==='info') renderInfoHome();
      if(tab==='brands') renderBrands();
      if(tab==='articles') renderArticles();
    }

    function renderInfoHome(){
      view.innerHTML='';
      const wrap=document.createElement('div');wrap.className='level-select';
      Object.keys(levelNames).forEach(k=>{
        if(categories.some(c=>c.type===k)){
          const btn=document.createElement('button');
          btn.textContent=levelNames[k];
          btn.onclick=()=>renderLevel(k);
          wrap.appendChild(btn);
        }
      });
      view.appendChild(wrap);
    }

    function renderLevel(k){
      view.innerHTML='';
      const back=document.createElement('button');back.className='back';back.textContent='‚Üê –ù–∞–∑–∞–¥';back.onclick=renderInfoHome;
      const h=document.createElement('h2');h.textContent=levelNames[k];
      const ul=document.createElement('ul');ul.className='topics';
      categories.filter(c=>c.type===k).forEach(c=>{
        const li=document.createElement('li');
        li.innerHTML='<strong>'+c.name+'</strong>'+(c.description?'<br><span class="muted">'+c.description+'</span>':'');
        ul.appendChild(li);
      });
      view.append(back,h,ul);
    }

    function renderBrands(){
      view.innerHTML='';
      const div=document.createElement('div');div.className='brand-list';
      categories.filter(c=>c.type==='brand').forEach(c=>{
        const el=document.createElement('div');el.textContent=c.name;div.appendChild(el);
      });
      view.appendChild(div);
    }

    function renderArticles(){
      view.innerHTML='';
      const list=document.createElement('div');list.className='article-list';
      categories.filter(c=>c.type==='article').forEach(c=>{
        const item=document.createElement('div');
        item.textContent=c.name;
        item.onclick=()=>renderArticleList(c);
        list.appendChild(item);
      });
      view.appendChild(list);
    }

    function renderArticleList(cat){
      currentCategory = cat;
      view.innerHTML='';
      const back=document.createElement('button');back.className='back';back.textContent='‚Üê –ù–∞–∑–∞–¥';back.onclick=renderArticles;
      const list=document.createElement('div');list.className='article-list';
      articles.filter(a=>a.category_id===cat.id).forEach(a=>{
        const item=document.createElement('div');
        item.innerHTML='<strong>'+a.title+'</strong>'+(a.summary?'<br><span class="muted">'+a.summary+'</span>':'');
        item.onclick=()=>renderArticle(a);
        list.appendChild(item);
      });
      view.append(back,list);
    }

    function renderArticle(a){
      view.innerHTML='';
      const back=document.createElement('button');back.className='back';back.textContent='‚Üê –ù–∞–∑–∞–¥';back.onclick=()=>renderArticleList(currentCategory);
      const box=document.createElement('div');box.className='article';
      box.innerHTML='<h2>'+a.title+'</h2>'+(a.content?'<p>'+a.content+'</p>':'');
      view.append(back,box);
    }

    // initial load
    loadData();
  </script>
</body>
</html>
